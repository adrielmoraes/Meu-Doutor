2025-11-14T17:57:10.922483+00:00"}
{"message": "process initialized", "level": "INFO", "name": "livekit.agents", "pid": 8299, "elapsed_time": 0.46, "timestamp": "2025-11-14T17:57:11.346037+00:00"}
{"message": "process initialized", "level": "INFO", "name": "livekit.agents", "pid": 8296, "elapsed_time": 0.52, "timestamp": "2025-11-14T17:57:11.388919+00:00"}
{"message": "process initialized", "level": "INFO", "name": "livekit.agents", "pid": 8304, "elapsed_time": 0.47, "timestamp": "2025-11-14T17:57:11.393845+00:00"}
{"message": "process initialized", "level": "INFO", "name": "livekit.agents", "pid": 8301, "elapsed_time": 0.52, "timestamp": "2025-11-14T17:57:11.412336+00:00"}
{"message": "registered worker", "level": "INFO", "name": "livekit.agents", "id": "AW_9QNcQyZAsfcR", "url": "wss://mediai-livikit-gmavbnbs.livekit.cloud", "region": "US West B", "protocol": 16, "timestamp": "2025-11-14T17:57:11.597025+00:00"}
{"message": "received job request", "level": "INFO", "name": "livekit.agents", "job_id": "AJ_iW3tqZREnCVM", "dispatch_id": "AD_WA6XmraSrTRm", "room_name": "mediai-consultation-c8b5a464-aa1b-4a33-8eaf-306a67f068d2", "agent_name": "", "resuming": false, "timestamp": "2025-11-14T18:00:15.869788+00:00"}
{"message": "initializing process", "level": "INFO", "name": "livekit.agents", "pid": 8992, "timestamp": "2025-11-14T18:00:15.953600+00:00"}
{"message": "process initialized", "level": "INFO", "name": "livekit.agents", "pid": 8992, "elapsed_time": 0.18, "timestamp": "2025-11-14T18:00:16.136660+00:00"}
{"message": "[MediAI] üéØ Starting agent for patient: c8b5a464-aa1b-4a33-8eaf-306a67f068d2", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:16.325572+00:00"}
{"message": "[Metrics] AGENT_SECRET n√£o configurado - m√©tricas n√£o ser√£o enviadas", "level": "WARNING", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:16.325791+00:00"}
{"message": "[Metrics] üìä Iniciado coletor de m√©tricas para sess√£o mediai-consultation-c8b5a464-aa1b-4a33-8eaf-306a67f068d2", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:16.325876+00:00"}
{"message": "[MediAI] üìã Loading patient context...", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:16.325923+00:00"}
{"message": "[MediAI] ‚úÖ Patient context loaded (651 chars)", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:20.062191+00:00"}
{"message": "[MediAI] ü§ñ Creating Gemini Live API model...", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:20.062306+00:00"}
{"message": "[MediAI] üéôÔ∏è Creating agent session with Gemini Live API...", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:20.062345+00:00"}
{"message": "[MediAI] üè• Starting medical consultation session...", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:20.063185+00:00"}
{"message": "Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY.", "level": "WARNING", "name": "google_genai._api_client", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:20.066945+00:00"}
{"message": "[MediAI] ‚è≥ Waiting for avatar to be visible and audio/video to sync...", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:20.118423+00:00"}
{"message": "[MediAI] ‚úÖ Session started successfully!", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:20.119806+00:00"}
{"message": "[MediAI] Avatar provider configured: bey", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:21.583409+00:00"}
{"message": "[MediAI] üé≠ Avatar provider selected: bey", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:21.583572+00:00"}
{"message": "[MediAI] üé≠ Initializing Beyond Presence (BEY) avatar...", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:21.583632+00:00"}
{"message": "[MediAI] üé• Starting BEY avatar...", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:21.583703+00:00"}
{"message": "Gemini Realtime API error: received 1008 (policy violation) models/gemini-2.0-flash is not found for API version v1beta, or is not supported for bidiGenerateContent. Call ListModels t; then sent 1008 (policy violation) models/gemini-2.0-flash is not found for API version v1beta, or is not supported for bidiGenerateContent. Call ListModels t\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/plugins/google/realtime/realtime_api.py\", line 667, in _main_task\n    async with self._client.aio.live.connect(\n  File \"/nix/store/7d088dip86hlzri9sk0h78b63yfmx0a0-python3-3.11.13/lib/python3.11/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/google/genai/live.py\", line 1085, in connect\n    raw_response = await ws.recv(decode=False)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/websockets/asyncio/connection.py\", line 322, in recv\n    raise self.protocol.close_exc from self.recv_exc\nwebsockets.exceptions.ConnectionClosedError: received 1008 (policy violation) models/gemini-2.0-flash is not found for API version v1beta, or is not supported for bidiGenerateContent. Call ListModels t; then sent 1008 (policy violation) models/gemini-2.0-flash is not found for API version v1beta, or is not supported for bidiGenerateContent. Call ListModels t", "level": "ERROR", "name": "livekit.plugins.google", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:21.751278+00:00"}
{"message": "AgentSession is closing due to unrecoverable error\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/plugins/google/realtime/realtime_api.py\", line 667, in _main_task\n    async with self._client.aio.live.connect(\n  File \"/nix/store/7d088dip86hlzri9sk0h78b63yfmx0a0-python3-3.11.13/lib/python3.11/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/google/genai/live.py\", line 1085, in connect\n    raw_response = await ws.recv(decode=False)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/websockets/asyncio/connection.py\", line 322, in recv\n    raise self.protocol.close_exc from self.recv_exc\nwebsockets.exceptions.ConnectionClosedError: received 1008 (policy violation) models/gemini-2.0-flash is not found for API version v1beta, or is not supported for bidiGenerateContent. Call ListModels t; then sent 1008 (policy violation) models/gemini-2.0-flash is not found for API version v1beta, or is not supported for bidiGenerateContent. Call ListModels t", "level": "ERROR", "name": "livekit.agents", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:21.753349+00:00"}
{"message": "Error in _main_task\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/plugins/google/realtime/realtime_api.py\", line 667, in _main_task\n    async with self._client.aio.live.connect(\n  File \"/nix/store/7d088dip86hlzri9sk0h78b63yfmx0a0-python3-3.11.13/lib/python3.11/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/google/genai/live.py\", line 1085, in connect\n    raw_response = await ws.recv(decode=False)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/websockets/asyncio/connection.py\", line 322, in recv\n    raise self.protocol.close_exc from self.recv_exc\nwebsockets.exceptions.ConnectionClosedError: received 1008 (policy violation) models/gemini-2.0-flash is not found for API version v1beta, or is not supported for bidiGenerateContent. Call ListModels t; then sent 1008 (policy violation) models/gemini-2.0-flash is not found for API version v1beta, or is not supported for bidiGenerateContent. Call ListModels t\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/utils/log.py\", line 16, in async_fn_logs\n    return await fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/plugins/google/realtime/realtime_api.py\", line 717, in _main_task\n    raise APIConnectionError(message=\"Failed to connect to Gemini Live\") from e\nlivekit.agents._exceptions.APIConnectionError: Failed to connect to Gemini Live (body=None, retryable=True)", "level": "ERROR", "name": "livekit.plugins.google", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:21.753938+00:00"}
{"message": "resume_false_interruption is enabled, but the audio output does not support pause, ignored", "level": "WARNING", "name": "livekit.agents", "audio_output": "DataStreamIO", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:24.830884+00:00"}
{"message": "[MediAI] ‚úÖ Beyond Presence avatar started successfully!", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:24.831027+00:00"}
{"message": "[MediAI] üëÅÔ∏è Starting visual analysis...", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:25.120559+00:00"}
{"message": "[MediAI] üé§ Generating initial greeting...", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:25.120748+00:00"}
{"message": "Error in _traceable_on_enter\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/utils/log.py\", line 16, in async_fn_logs\n    return await fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/voice/agent_activity.py\", line 434, in _traceable_on_enter\n    await self._agent.on_enter()\n  File \"/home/runner/workspace/livekit-agent/agent.py\", line 539, in on_enter\n    await self.session.generate_reply(instructions=initial_greeting)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/voice/agent_session.py\", line 836, in generate_reply\n    raise RuntimeError(\"AgentSession is closing, cannot use generate_reply()\")\nRuntimeError: AgentSession is closing, cannot use generate_reply()", "level": "ERROR", "name": "livekit.agents", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:25.120866+00:00"}
{"message": "[Metrics] üîÑ Iniciando envio peri√≥dico de m√©tricas a cada 60s...", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:25.122799+00:00"}
{"message": "[Vision] üì∏ Analisando apar√™ncia do paciente...", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:45.126011+00:00"}
{"message": "[Vision] ‚úÖ Contexto visual: Estou vendo o paciente atrav√©s da c√¢mera. Posso ver sua express√£o facial e ambiente ao redor.", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:00:45.126131+00:00"}
{"message": "[Vision] üì∏ Analisando apar√™ncia do paciente...", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:01:00.127985+00:00"}
{"message": "[Vision] ‚úÖ Contexto visual: Estou vendo o paciente atrav√©s da c√¢mera. Posso ver sua express√£o facial e ambiente ao redor.", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:01:00.128168+00:00"}
{"message": "[Vision] üì∏ Analisando apar√™ncia do paciente...", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:01:15.129882+00:00"}
{"message": "[Vision] ‚úÖ Contexto visual: Estou vendo o paciente atrav√©s da c√¢mera. Posso ver sua express√£o facial e ambiente ao redor.", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:01:15.130034+00:00"}
{"message": "[Metrics] N√£o √© poss√≠vel enviar m√©tricas sem AGENT_SECRET", "level": "WARNING", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:01:25.127501+00:00"}
{"message": "[Vision] üì∏ Analisando apar√™ncia do paciente...", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:01:30.131820+00:00"}
{"message": "[Vision] ‚úÖ Contexto visual: Estou vendo o paciente atrav√©s da c√¢mera. Posso ver sua express√£o facial e ambiente ao redor.", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:01:30.131993+00:00"}
{"message": "[Vision] üì∏ Analisando apar√™ncia do paciente...", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:01:45.134497+00:00"}
{"message": "[Vision] ‚úÖ Contexto visual: Estou vendo o paciente atrav√©s da c√¢mera. Posso ver sua express√£o facial e ambiente ao redor.", "level": "INFO", "name": "mediai-avatar", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:01:45.134760+00:00"}
{"message": "process exiting", "level": "INFO", "name": "livekit.agents", "reason": "", "pid": 8299, "job_id": "AJ_iW3tqZREnCVM", "timestamp": "2025-11-14T18:01:52.963941+00:00"}
