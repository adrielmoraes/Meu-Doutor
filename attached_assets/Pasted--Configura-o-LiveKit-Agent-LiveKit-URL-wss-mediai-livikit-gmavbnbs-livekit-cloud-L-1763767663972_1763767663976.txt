
‚úÖ Configura√ß√£o LiveKit Agent:
  ‚Ä¢ LiveKit URL: wss://mediai-livikit-gmavbnbs.livekit.cloud
  ‚Ä¢ LiveKit API Key: APIrYvWHxL...
  ‚Ä¢ Gemini API: ‚úÖ Configurado (100% Gemini powered)
  ‚Ä¢ Avatar Providers Dispon√≠veis:
    - Tavus: ‚ö™ N√£o configurado
      API Key: ‚úó
      Replica ID: ‚úì
      Persona ID: ‚úì
    - Beyond Presence (BEY): üé≠ CONFIGURADO
      Avatar ID: f30d7eef-6e71-433f-938d-cecdd8c0b653
  ‚Ä¢ Avatar Ativo: Definido no Admin Panel (banco de dados)
  ‚Ä¢ Database: ‚úÖ Configurado

============================================================
üé≠ Iniciando MediAI Agent...
   üì° Aguardando pacientes na sala LiveKit...
   üé• O avatar Tavus aparecer√° automaticamente quando
   üè• um paciente iniciar uma consulta!
   üß† 100% Gemini API (STT + LLM + TTS)
============================================================

{"level": "INFO", "name": "livekit.agents", "message": "starting worker", "version": "1.3.3", "rtc-version": "1.0.19", "timestamp": "2025-11-21T23:17:09.464059+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "preloading plugins", "packages": ["livekit.plugins.tavus", "livekit.plugins.bey", "livekit.plugins.google", "av"], "timestamp": "2025-11-21T23:17:09.464201+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "initializing process", "pid": 14934, "timestamp": "2025-11-21T23:17:11.553146+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "initializing process", "pid": 14936, "timestamp": "2025-11-21T23:17:11.558928+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "initializing process", "pid": 14938, "timestamp": "2025-11-21T23:17:11.572802+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "initializing process", "pid": 14940, "timestamp": "2025-11-21T23:17:11.581763+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "process initialized", "pid": 14934, "elapsed_time": 0.42, "timestamp": "2025-11-21T23:17:11.971132+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "process initialized", "pid": 14936, "elapsed_time": 0.47, "timestamp": "2025-11-21T23:17:12.025238+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "process initialized", "pid": 14938, "elapsed_time": 0.46, "timestamp": "2025-11-21T23:17:12.031820+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "process initialized", "pid": 14940, "elapsed_time": 0.46, "timestamp": "2025-11-21T23:17:12.046323+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "registered worker", "agent_name": "", "id": "AW_vzic8KACB5mt", "url": "wss://mediai-livikit-gmavbnbs.livekit.cloud", "region": "US East B", "protocol": 16, "timestamp": "2025-11-21T23:17:12.180825+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "received job request", "job_id": "AJ_rkqtknMjPu54", "dispatch_id": "AD_AbxwGuoyGGQo", "room": "mediai-consultation-c8b5a464-aa1b-4a33-8eaf-306a67f068d2", "room_id": "RM_qwmgtpNJBoH9", "agent_name": "", "resuming": false, "enable_recording": false, "timestamp": "2025-11-21T23:23:34.293939+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "initializing process", "pid": 14958, "timestamp": "2025-11-21T23:23:34.320668+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "process initialized", "pid": 14958, "elapsed_time": 0.31, "timestamp": "2025-11-21T23:23:34.628251+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[MediAI] üéØ Starting agent for patient: c8b5a464-aa1b-4a33-8eaf-306a67f068d2", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:34.640351+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Metrics] üìä Iniciado coletor de m√©tricas para sess√£o mediai-consultation-c8b5a464-aa1b-4a33-8eaf-306a67f068d2", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:34.640464+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[MediAI] üìã Loading patient context...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:34.640498+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[MediAI] ‚úÖ Patient context loaded (651 chars)", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:37.557565+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[MediAI] ü§ñ Creating Gemini Live API model...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:37.557732+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[MediAI] üéôÔ∏è Creating agent session with Gemini Live API...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:37.557785+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[MediAI] üè• Starting medical consultation session...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:37.559068+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[MediAI] üõ†Ô∏è Function tools ser√£o executados automaticamente pelo LiveKit", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:37.559137+00:00"}
{"level": "WARNING", "name": "google_genai._api_client", "message": "Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY.", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:37.563919+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[MediAI] ‚è≥ Waiting for avatar to be visible and audio/video to sync...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:37.658905+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[MediAI] ‚úÖ Session started successfully!", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:37.660392+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[MediAI] üìπ Using periodic vision analysis (every 20s) instead of continuous streaming", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:37.660430+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[MediAI] Avatar provider configured: bey", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:38.751756+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[MediAI] üé≠ Avatar provider selected: bey", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:38.751925+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[MediAI] üé≠ Initializing Beyond Presence (BEY) avatar...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:38.751973+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[MediAI] üé• Starting BEY avatar...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:38.752028+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "resume_false_interruption is enabled, but the audio output does not support pause, ignored", "audio_output": "DataStreamIO", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:41.871732+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[MediAI] ‚úÖ Beyond Presence avatar started successfully!", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:41.871851+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[MediAI] üëÅÔ∏è Vision loop ready (will activate when patient speaks)...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:42.661345+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[MediAI] üé§ Generating initial greeting in PT-BR...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:42.661605+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Metrics] üîÑ Iniciando envio peri√≥dico de m√©tricas a cada 60s...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:42.662179+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] üí§ Vision loop waiting for patient to start speaking...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:47.663650+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "playback finished event received", "caller_identity": "bey-avatar-agent", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:23:51.994371+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: Ol√°, boa noite....", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:35.682836+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] üé¨ Patient started speaking - activating vision analysis!", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:35.682899+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: Ol√°, boa noite....", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:39.602228+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "playback finished event received", "caller_identity": "bey-avatar-agent", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:40.872256+00:00"}
{"level": "WARNING", "name": "mediai-avatar", "message": "[Metrics] Erro ao enviar m√©tricas: All connection attempts failed. Retry 1/3 em 1s...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:42.677743+00:00"}
{"level": "WARNING", "name": "mediai-avatar", "message": "[Metrics] Erro ao enviar m√©tricas: All connection attempts failed. Retry 2/3 em 2s...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:43.686796+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: ....", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:44.383386+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: . contra...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:45.322407+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: . contra algun m√©dico para mim....", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:45.645480+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéØ Detected doctor request! Specialty: General", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:45.645577+00:00"}
Traceback (most recent call last):
  File "/home/runner/workspace/livekit-agent/agent.py", line 1031, in _handle_user_transcription
    doctors_result = await search_doctors(specialty=detected_specialty, limit=10)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: search_doctors() missing 1 required positional argument: 'context'
{"level": "ERROR", "name": "mediai-avatar", "message": "[Intent] Error handling transcription: search_doctors() missing 1 required positional argument: 'context'", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:45.645630+00:00"}
{"level": "WARNING", "name": "mediai-avatar", "message": "[Metrics] Erro ao enviar m√©tricas: All connection attempts failed. Retry 3/3 em 4s...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:45.696017+00:00"}
{"level": "ERROR", "name": "mediai-avatar", "message": "[Metrics] ‚ùå Falha ao enviar m√©tricas ap√≥s 3 tentativas: All connection attempts failed", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:49.704948+00:00"}
Traceback (most recent call last):
  File "/home/runner/workspace/livekit-agent/agent.py", line 1031, in _handle_user_transcription
    doctors_result = await search_doctors(specialty=detected_specialty, limit=10)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: search_doctors() missing 1 required positional argument: 'context'
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: . contra algun m√©dico para mim....", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:53.603624+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéØ Detected doctor request! Specialty: General", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:53.603725+00:00"}
{"level": "ERROR", "name": "mediai-avatar", "message": "[Intent] Error handling transcription: search_doctors() missing 1 required positional argument: 'context'", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:53.603773+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "playback finished event received", "caller_identity": "bey-avatar-agent", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:54.820680+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Memory] üìä Antes da captura: 202.88 MB", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:55.700757+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] üì∏ Capturando frame real do paciente...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:55.700931+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] Frame captured: 1816x1020", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:55.741335+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] Converting frame 1816x1020 (type=5) to JPEG...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:55.741507+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] ‚úÖ Converted to RGB via RGBA successfully", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:55.837787+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] ‚úÖ Frame converted to JPEG (127924 bytes)", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:24:55.868382+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: N√£o...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:03.672430+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: N√£o, eu...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:03.847689+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: N√£o, eu go...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:04.033713+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: N√£o, eu goste...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:04.182054+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: N√£o, eu gostei de...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:04.338334+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: N√£o, eu gostei de saber...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:04.496315+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: N√£o, eu gostei de saber se...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:04.669283+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: N√£o, eu gostei de saber se alguma...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:04.847429+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: N√£o, eu gostei de saber se alguma plataforma dispon√≠vel....", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:05.143816+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: N√£o, eu gostei de saber se alguma plataforma dispon√≠vel....", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:06.289869+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "playback finished event received", "caller_identity": "bey-avatar-agent", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:06.585834+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] ‚úÖ An√°lise: A imagem apresenta uma mulher jovem adulta, de apar√™ncia asi√°tica, com cabelos escuros e longos. Ela...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:06.924268+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Metrics] Vision: +330 input, +86 output tokens", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:06.924400+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] üéâ Real visual analysis completed successfully!", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:06.924437+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] ‚úÖ REAL visual analysis: A imagem apresenta uma mulher jovem adulta, de apar√™ncia asi√°tica, com cabelos escuros e longos. Ela...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:07.040127+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Memory] üìä Depois da limpeza: 480.08 MB (Œî +277.20 MB)", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:07.291750+00:00"}
{"level": "WARNING", "name": "mediai-avatar", "message": "[Memory] ‚ö†Ô∏è Crescimento significativo detectado: +277.20 MB!", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:07.291878+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: ou...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:08.113561+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: ou com...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:08.288297+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: ou com age...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:08.612074+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: ou com agenda...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:08.913905+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: ou com agendamento...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:09.085593+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: ou com agendamento ou...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:09.413600+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: ou com agendamento ou alguma coisa assim....", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:11.064417+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process memory usage is high", "memory_usage_mb": 812.25, "memory_warn_mb": 500, "memory_limit_mb": 0, "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:12.070953+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process memory usage is high", "memory_usage_mb": 1144.09765625, "memory_warn_mb": 500, "memory_limit_mb": 0, "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:17.071731+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process memory usage is high", "memory_usage_mb": 1474.78125, "memory_warn_mb": 500, "memory_limit_mb": 0, "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:22.072821+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: ou com agendamento ou alguma coisa assim....", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:25.257755+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "playback finished event received", "caller_identity": "bey-avatar-agent", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:26.660278+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process memory usage is high", "memory_usage_mb": 1715.97265625, "memory_warn_mb": 500, "memory_limit_mb": 0, "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:27.073387+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Memory] üìä Antes da captura: 1729.23 MB", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:27.292675+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] üì∏ Capturando frame real do paciente...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:27.292866+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] Frame captured: 1816x1020", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:27.304444+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] Converting frame 1816x1020 (type=5) to JPEG...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:27.304615+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] ‚úÖ Converted to RGB via RGBA successfully", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:27.348044+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] ‚úÖ Frame converted to JPEG (127111 bytes)", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:27.354856+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: Me...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:28.513398+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: Meu...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:28.688680+00:00"}
Traceback (most recent call last):
  File "/home/runner/workspace/livekit-agent/agent.py", line 1031, in _handle_user_transcription
    doctors_result = await search_doctors(specialty=detected_specialty, limit=10)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: search_doctors() missing 1 required positional argument: 'context'
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: Meu ent√£o...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:28.863787+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: Meu ent√£o um doutor...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:28.863907+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéØ Detected doctor request! Specialty: General", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:28.863954+00:00"}
{"level": "ERROR", "name": "mediai-avatar", "message": "[Intent] Error handling transcription: search_doctors() missing 1 required positional argument: 'context'", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:28.864009+00:00"}
Traceback (most recent call last):
  File "/home/runner/workspace/livekit-agent/agent.py", line 1031, in _handle_user_transcription
    doctors_result = await search_doctors(specialty=detected_specialty, limit=10)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: search_doctors() missing 1 required positional argument: 'context'
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: Meu ent√£o um doutor...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:29.168920+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéØ Detected doctor request! Specialty: General", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:29.168974+00:00"}
{"level": "ERROR", "name": "mediai-avatar", "message": "[Intent] Error handling transcription: search_doctors() missing 1 required positional argument: 'context'", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:29.169005+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[AI Tools] Buscando m√©dicos: https://www.appmediai.com/api/ai-agent/doctors (especialidade=dermatologia)", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:29.177767+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[AI Tools] Headers: x-agent-secret presente: True", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:29.177829+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "playback finished event received", "caller_identity": "bey-avatar-agent", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:29.299931+00:00"}
{"level": "ERROR", "name": "mediai-avatar", "message": "[AI Tools] ‚ùå HTTP Error 401: {\"error\":\"N√£o autorizado\"}", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:29.508780+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process memory usage is high", "memory_usage_mb": 1779.94140625, "memory_warn_mb": 500, "memory_limit_mb": 0, "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:32.074339+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] ‚úÖ An√°lise: Uma mulher de apar√™ncia asi√°tica, com cabelos longos e escuros, veste um uniforme m√©dico (scrubs) bo...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:35.128299+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Metrics] Vision: +330 input, +76 output tokens", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:35.128473+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] üéâ Real visual analysis completed successfully!", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:35.128645+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] ‚úÖ REAL visual analysis: Uma mulher de apar√™ncia asi√°tica, com cabelos longos e escuros, veste um uniforme m√©dico (scrubs) bo...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:35.291096+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Memory] üìä Depois da limpeza: 1780.45 MB (Œî +51.22 MB)", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:35.510856+00:00"}
{"level": "WARNING", "name": "mediai-avatar", "message": "[Memory] ‚ö†Ô∏è Crescimento significativo detectado: +51.22 MB!", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:35.510976+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process memory usage is high", "memory_usage_mb": 1780.453125, "memory_warn_mb": 500, "memory_limit_mb": 0, "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:37.075608+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process memory usage is high", "memory_usage_mb": 1780.453125, "memory_warn_mb": 500, "memory_limit_mb": 0, "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:42.076466+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process memory usage is high", "memory_usage_mb": 1780.45703125, "memory_warn_mb": 500, "memory_limit_mb": 0, "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:47.077616+00:00"}
{"level": "WARNING", "name": "mediai-avatar", "message": "[Metrics] Erro ao enviar m√©tricas: All connection attempts failed. Retry 1/3 em 1s...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:49.721889+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "playback finished event received", "caller_identity": "bey-avatar-agent", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:49.810338+00:00"}
{"level": "WARNING", "name": "mediai-avatar", "message": "[Metrics] Erro ao enviar m√©tricas: All connection attempts failed. Retry 2/3 em 2s...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:50.735373+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process memory usage is high", "memory_usage_mb": 1767.5, "memory_warn_mb": 500, "memory_limit_mb": 0, "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:52.078799+00:00"}
{"level": "WARNING", "name": "mediai-avatar", "message": "[Metrics] Erro ao enviar m√©tricas: All connection attempts failed. Retry 3/3 em 4s...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:52.744089+00:00"}
{"level": "WARNING", "name": "livekit.plugins.google", "message": "server cancelled tool calls", "function_call_ids": ["function-call-8318685925833241086"], "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:54.371351+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Memory] üìä Antes da captura: 1776.80 MB", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:55.513061+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] üì∏ Capturando frame real do paciente...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:55.513198+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] Frame captured: 320x180", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:55.577622+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] Converting frame 320x180 (type=5) to JPEG...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:55.577763+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] ‚úÖ Converted to RGB via RGBA successfully", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:55.580076+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] ‚úÖ Frame converted to JPEG (10288 bytes)", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:55.580533+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: m√©...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:56.488059+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "didn't receive playback finished event after clear buffer, marking playout as done arbitrarily", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:56.489451+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "playback_finished called more times than playback segments were captured", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:56.489543+00:00"}
Traceback (most recent call last):
  File "/home/runner/workspace/livekit-agent/agent.py", line 1031, in _handle_user_transcription
    doctors_result = await search_doctors(specialty=detected_specialty, limit=10)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: search_doctors() missing 1 required positional argument: 'context'
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: m√©dico...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:56.666066+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéØ Detected doctor request! Specialty: General", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:56.666126+00:00"}
{"level": "ERROR", "name": "mediai-avatar", "message": "[Intent] Error handling transcription: search_doctors() missing 1 required positional argument: 'context'", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:56.666162+00:00"}
{"level": "ERROR", "name": "mediai-avatar", "message": "[Metrics] ‚ùå Falha ao enviar m√©tricas ap√≥s 3 tentativas: All connection attempts failed", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:56.751841+00:00"}
Traceback (most recent call last):
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: m√©dico dis...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:56.827413+00:00"}
  File "/home/runner/workspace/livekit-agent/agent.py", line 1031, in _handle_user_transcription
    doctors_result = await search_doctors(specialty=detected_specialty, limit=10)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: search_doctors() missing 1 required positional argument: 'context'
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéØ Detected doctor request! Specialty: General", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:56.827540+00:00"}
{"level": "ERROR", "name": "mediai-avatar", "message": "[Intent] Error handling transcription: search_doctors() missing 1 required positional argument: 'context'", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:56.827595+00:00"}
Traceback (most recent call last):
  File "/home/runner/workspace/livekit-agent/agent.py", line 1031, in _handle_user_transcription
    doctors_result = await search_doctors(specialty=detected_specialty, limit=10)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: search_doctors() missing 1 required positional argument: 'context'
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: m√©dico disponible na plataforma....", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:56.872884+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéØ Detected doctor request! Specialty: General", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:56.873120+00:00"}
{"level": "ERROR", "name": "mediai-avatar", "message": "[Intent] Error handling transcription: search_doctors() missing 1 required positional argument: 'context'", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:56.873177+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process memory usage is high", "memory_usage_mb": 1783.75, "memory_warn_mb": 500, "memory_limit_mb": 0, "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:57.079916+00:00"}
Traceback (most recent call last):
  File "/home/runner/workspace/livekit-agent/agent.py", line 1031, in _handle_user_transcription
    doctors_result = await search_doctors(specialty=detected_specialty, limit=10)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: search_doctors() missing 1 required positional argument: 'context'
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: m√©dico disponible na plataforma....", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:57.438238+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéØ Detected doctor request! Specialty: General", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:57.438322+00:00"}
{"level": "ERROR", "name": "mediai-avatar", "message": "[Intent] Error handling transcription: search_doctors() missing 1 required positional argument: 'context'", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:57.438367+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[AI Tools] Buscando m√©dicos: https://www.appmediai.com/api/ai-agent/doctors (especialidade=dermatologia)", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:57.449455+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[AI Tools] Headers: x-agent-secret presente: True", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:57.449566+00:00"}
{"level": "ERROR", "name": "mediai-avatar", "message": "[AI Tools] ‚ùå HTTP Error 401: {\"error\":\"N√£o autorizado\"}", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:25:57.616198+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] ‚úÖ An√°lise: Mulher jovem, de etnia asi√°tica, com cabelos longos e escuros, veste uniforme m√©dico (scrubs vinho) ...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:01.465246+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Metrics] Vision: +330 input, +81 output tokens", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:01.465398+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] üéâ Real visual analysis completed successfully!", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:01.465439+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] ‚úÖ REAL visual analysis: Mulher jovem, de etnia asi√°tica, com cabelos longos e escuros, veste uniforme m√©dico (scrubs vinho) ...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:01.646773+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Memory] üìä Depois da limpeza: 2208.57 MB (Œî +431.77 MB)", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:01.971645+00:00"}
{"level": "WARNING", "name": "mediai-avatar", "message": "[Memory] ‚ö†Ô∏è Crescimento significativo detectado: +431.77 MB!", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:01.971765+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process memory usage is high", "memory_usage_mb": 2301.3046875, "memory_warn_mb": 500, "memory_limit_mb": 0, "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:02.081437+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "playback finished event received", "caller_identity": "bey-avatar-agent", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:06.302947+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process memory usage is high", "memory_usage_mb": 3158.46484375, "memory_warn_mb": 500, "memory_limit_mb": 0, "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:07.083879+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process memory usage is high", "memory_usage_mb": 4153.7578125, "memory_warn_mb": 500, "memory_limit_mb": 0, "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:12.085135+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: m√©...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:12.891302+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: m√©di...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:13.052935+00:00"}
Traceback (most recent call last):
  File "/home/runner/workspace/livekit-agent/agent.py", line 1031, in _handle_user_transcription
    doctors_result = await search_doctors(specialty=detected_specialty, limit=10)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: search_doctors() missing 1 required positional argument: 'context'
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: m√©dico...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:13.230028+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéØ Detected doctor request! Specialty: General", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:13.230079+00:00"}
{"level": "ERROR", "name": "mediai-avatar", "message": "[Intent] Error handling transcription: search_doctors() missing 1 required positional argument: 'context'", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:13.230113+00:00"}
Traceback (most recent call last):
  File "/home/runner/workspace/livekit-agent/agent.py", line 1031, in _handle_user_transcription
    doctors_result = await search_doctors(specialty=detected_specialty, limit=10)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: search_doctors() missing 1 required positional argument: 'context'
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: m√©dico co...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:13.387068+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéØ Detected doctor request! Specialty: General", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:13.387187+00:00"}
{"level": "ERROR", "name": "mediai-avatar", "message": "[Intent] Error handling transcription: search_doctors() missing 1 required positional argument: 'context'", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:13.387242+00:00"}
Traceback (most recent call last):
  File "/home/runner/workspace/livekit-agent/agent.py", line 1031, in _handle_user_transcription
    doctors_result = await search_doctors(specialty=detected_specialty, limit=10)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: search_doctors() missing 1 required positional argument: 'context'
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: m√©dico condu...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:13.547668+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéØ Detected doctor request! Specialty: General", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:13.547734+00:00"}
{"level": "ERROR", "name": "mediai-avatar", "message": "[Intent] Error handling transcription: search_doctors() missing 1 required positional argument: 'context'", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:13.547781+00:00"}
Traceback (most recent call last):
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: m√©dico conductor...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:13.688143+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéØ Detected doctor request! Specialty: General", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:13.688195+00:00"}
{"level": "ERROR", "name": "mediai-avatar", "message": "[Intent] Error handling transcription: search_doctors() missing 1 required positional argument: 'context'", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:13.688228+00:00"}
  File "/home/runner/workspace/livekit-agent/agent.py", line 1031, in _handle_user_transcription
    doctors_result = await search_doctors(specialty=detected_specialty, limit=10)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: search_doctors() missing 1 required positional argument: 'context'
Traceback (most recent call last):
  File "/home/runner/workspace/livekit-agent/agent.py", line 1031, in _handle_user_transcription
    doctors_result = await search_doctors(specialty=detected_specialty, limit=10)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: search_doctors() missing 1 required positional argument: 'context'
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéôÔ∏è Patient said: m√©dico conductor Daniel...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:13.887447+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Intent] üéØ Detected doctor request! Specialty: General", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:13.887566+00:00"}
{"level": "ERROR", "name": "mediai-avatar", "message": "[Intent] Error handling transcription: search_doctors() missing 1 required positional argument: 'context'", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:13.887618+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process memory usage is high", "memory_usage_mb": 5137.61328125, "memory_warn_mb": 500, "memory_limit_mb": 0, "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:17.086872+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Memory] üìä Antes da captura: 6018.24 MB", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:22.000640+00:00"}
{"level": "INFO", "name": "mediai-avatar", "message": "[Vision] üì∏ Capturando frame real do paciente...", "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:22.000800+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process memory usage is high", "memory_usage_mb": 6030.78515625, "memory_warn_mb": 500, "memory_limit_mb": 0, "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:22.090680+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process memory usage is high", "memory_usage_mb": 6133.1953125, "memory_warn_mb": 500, "memory_limit_mb": 0, "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:27.602734+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "worker is at full capacity, marking as unavailable", "load": 0.7584536000000001, "threshold": 0.7, "timestamp": "2025-11-21T23:26:28.304651+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process is unresponsive", "delay": 741, "pid": 14958, "timestamp": "2025-11-21T23:26:28.780275+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process is unresponsive", "delay": 744, "pid": 14938, "timestamp": "2025-11-21T23:26:28.783269+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process is unresponsive", "delay": 743, "pid": 14936, "timestamp": "2025-11-21T23:26:28.783450+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process is unresponsive", "delay": 744, "pid": 14940, "timestamp": "2025-11-21T23:26:28.783574+00:00"}
{"level": "INFO", "name": "livekit.agents", "message": "worker is below capacity, marking as available", "load": 0.5364089000000001, "threshold": 0.7, "timestamp": "2025-11-21T23:26:31.161591+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process is unresponsive", "delay": 744, "pid": 14940, "timestamp": "2025-11-21T23:26:31.284653+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process is unresponsive", "delay": 750, "pid": 14938, "timestamp": "2025-11-21T23:26:31.290823+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process is unresponsive", "delay": 749, "pid": 14958, "timestamp": "2025-11-21T23:26:31.291327+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process is unresponsive", "delay": 748, "pid": 14936, "timestamp": "2025-11-21T23:26:31.291494+00:00"}
{"level": "WARNING", "name": "livekit.agents", "message": "process memory usage is high", "memory_usage_mb": 6133.30078125, "memory_warn_mb": 500, "memory_limit_mb": 0, "pid": 14934, "job_id": "AJ_rkqtknMjPu54", "room_id": "RM_qwmgtpNJBoH9", "timestamp": "2025-11-21T23:26:34.302052+00:00"}