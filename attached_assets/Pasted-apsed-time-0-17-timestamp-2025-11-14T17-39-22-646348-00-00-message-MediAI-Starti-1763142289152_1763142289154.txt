apsed_time": 0.17, "timestamp": "2025-11-14T17:39:22.646348+00:00"}
{"message": "[MediAI] üéØ Starting agent for patient: c8b5a464-aa1b-4a33-8eaf-306a67f068d2", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:22.871617+00:00"}
{"message": "[Metrics] AGENT_SECRET n√£o configurado - m√©tricas n√£o ser√£o enviadas", "level": "WARNING", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:22.871787+00:00"}
{"message": "[Metrics] üìä Iniciado coletor de m√©tricas para sess√£o mediai-consultation-c8b5a464-aa1b-4a33-8eaf-306a67f068d2", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:22.871831+00:00"}
{"message": "[MediAI] üìã Loading patient context...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:22.871864+00:00"}
{"message": "[MediAI] ‚úÖ Patient context loaded (651 chars)", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:26.596724+00:00"}
{"message": "[MediAI] ü§ñ Creating Gemini Live API model...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:26.596843+00:00"}
{"message": "[MediAI] üéôÔ∏è Creating agent session with Gemini Live API...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:26.596880+00:00"}
{"message": "[MediAI] üè• Starting medical consultation session...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:26.597638+00:00"}
{"message": "Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY.", "level": "WARNING", "name": "google_genai._api_client", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:26.600745+00:00"}
{"message": "[MediAI] ‚è≥ Waiting for avatar to be visible and audio/video to sync...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:26.651837+00:00"}
{"message": "[MediAI] ‚úÖ Session started successfully!", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:26.652648+00:00"}
{"message": "[MediAI] Avatar provider configured: bey", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:28.149237+00:00"}
{"message": "[MediAI] üé≠ Avatar provider selected: bey", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:28.149427+00:00"}
{"message": "[MediAI] üé≠ Initializing Beyond Presence (BEY) avatar...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:28.149496+00:00"}
{"message": "[MediAI] üé• Starting BEY avatar...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:28.149565+00:00"}
{"message": "Gemini Realtime API error: received 1008 (policy violation) models/gemini-2.5-flash is not found for API version v1beta, or is not supported for bidiGenerateContent. Call ListModels t; then sent 1008 (policy violation) models/gemini-2.5-flash is not found for API version v1beta, or is not supported for bidiGenerateContent. Call ListModels t\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/plugins/google/realtime/realtime_api.py\", line 667, in _main_task\n    async with self._client.aio.live.connect(\n  File \"/nix/store/7d088dip86hlzri9sk0h78b63yfmx0a0-python3-3.11.13/lib/python3.11/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/google/genai/live.py\", line 1085, in connect\n    raw_response = await ws.recv(decode=False)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/websockets/asyncio/connection.py\", line 322, in recv\n    raise self.protocol.close_exc from self.recv_exc\nwebsockets.exceptions.ConnectionClosedError: received 1008 (policy violation) models/gemini-2.5-flash is not found for API version v1beta, or is not supported for bidiGenerateContent. Call ListModels t; then sent 1008 (policy violation) models/gemini-2.5-flash is not found for API version v1beta, or is not supported for bidiGenerateContent. Call ListModels t", "level": "ERROR", "name": "livekit.plugins.google", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:28.532039+00:00"}
{"message": "AgentSession is closing due to unrecoverable error\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/plugins/google/realtime/realtime_api.py\", line 667, in _main_task\n    async with self._client.aio.live.connect(\n  File \"/nix/store/7d088dip86hlzri9sk0h78b63yfmx0a0-python3-3.11.13/lib/python3.11/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/google/genai/live.py\", line 1085, in connect\n    raw_response = await ws.recv(decode=False)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/websockets/asyncio/connection.py\", line 322, in recv\n    raise self.protocol.close_exc from self.recv_exc\nwebsockets.exceptions.ConnectionClosedError: received 1008 (policy violation) models/gemini-2.5-flash is not found for API version v1beta, or is not supported for bidiGenerateContent. Call ListModels t; then sent 1008 (policy violation) models/gemini-2.5-flash is not found for API version v1beta, or is not supported for bidiGenerateContent. Call ListModels t", "level": "ERROR", "name": "livekit.agents", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:28.534461+00:00"}
{"message": "Error in _main_task\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/plugins/google/realtime/realtime_api.py\", line 667, in _main_task\n    async with self._client.aio.live.connect(\n  File \"/nix/store/7d088dip86hlzri9sk0h78b63yfmx0a0-python3-3.11.13/lib/python3.11/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/google/genai/live.py\", line 1085, in connect\n    raw_response = await ws.recv(decode=False)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/websockets/asyncio/connection.py\", line 322, in recv\n    raise self.protocol.close_exc from self.recv_exc\nwebsockets.exceptions.ConnectionClosedError: received 1008 (policy violation) models/gemini-2.5-flash is not found for API version v1beta, or is not supported for bidiGenerateContent. Call ListModels t; then sent 1008 (policy violation) models/gemini-2.5-flash is not found for API version v1beta, or is not supported for bidiGenerateContent. Call ListModels t\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/utils/log.py\", line 16, in async_fn_logs\n    return await fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/plugins/google/realtime/realtime_api.py\", line 717, in _main_task\n    raise APIConnectionError(message=\"Failed to connect to Gemini Live\") from e\nlivekit.agents._exceptions.APIConnectionError: Failed to connect to Gemini Live (body=None, retryable=True)", "level": "ERROR", "name": "livekit.plugins.google", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:28.535135+00:00"}
{"message": "resume_false_interruption is enabled, but the audio output does not support pause, ignored", "level": "WARNING", "name": "livekit.agents", "audio_output": "DataStreamIO", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:31.107434+00:00"}
{"message": "[MediAI] ‚úÖ Beyond Presence avatar started successfully!", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:31.107577+00:00"}
{"message": "[MediAI] üëÅÔ∏è Starting visual analysis...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:31.653091+00:00"}
{"message": "[MediAI] üé§ Generating initial greeting...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:31.653271+00:00"}
{"message": "Error in _traceable_on_enter\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/utils/log.py\", line 16, in async_fn_logs\n    return await fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/voice/agent_activity.py\", line 434, in _traceable_on_enter\n    await self._agent.on_enter()\n  File \"/home/runner/workspace/livekit-agent/agent.py\", line 539, in on_enter\n    await self.session.generate_reply(instructions=initial_greeting)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/voice/agent_session.py\", line 836, in generate_reply\n    raise RuntimeError(\"AgentSession is closing, cannot use generate_reply()\")\nRuntimeError: AgentSession is closing, cannot use generate_reply()", "level": "ERROR", "name": "livekit.agents", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:31.653434+00:00"}
{"message": "[Metrics] üîÑ Iniciando envio peri√≥dico de m√©tricas a cada 60s...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:31.655082+00:00"}
{"message": "[Vision] üì∏ Analisando apar√™ncia do paciente...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:51.661636+00:00"}
{"message": "[Vision] ‚úÖ Contexto visual: Estou vendo o paciente atrav√©s da c√¢mera. Posso ver sua express√£o facial e ambiente ao redor.", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:39:51.661755+00:00"}
{"message": "[Vision] üì∏ Analisando apar√™ncia do paciente...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:40:06.664663+00:00"}
{"message": "[Vision] ‚úÖ Contexto visual: Estou vendo o paciente atrav√©s da c√¢mera. Posso ver sua express√£o facial e ambiente ao redor.", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:40:06.664818+00:00"}
{"message": "[Vision] üì∏ Analisando apar√™ncia do paciente...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:40:21.668087+00:00"}
{"message": "[Vision] ‚úÖ Contexto visual: Estou vendo o paciente atrav√©s da c√¢mera. Posso ver sua express√£o facial e ambiente ao redor.", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:40:21.668424+00:00"}
{"message": "[Metrics] N√£o √© poss√≠vel enviar m√©tricas sem AGENT_SECRET", "level": "WARNING", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:40:31.657038+00:00"}
{"message": "[Vision] üì∏ Analisando apar√™ncia do paciente...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:40:36.671639+00:00"}
{"message": "[Vision] ‚úÖ Contexto visual: Estou vendo o paciente atrav√©s da c√¢mera. Posso ver sua express√£o facial e ambiente ao redor.", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:40:36.671790+00:00"}
{"message": "[Vision] üì∏ Analisando apar√™ncia do paciente...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:40:51.675561+00:00"}
{"message": "[Vision] ‚úÖ Contexto visual: Estou vendo o paciente atrav√©s da c√¢mera. Posso ver sua express√£o facial e ambiente ao redor.", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:40:51.675675+00:00"}
{"message": "[Vision] üì∏ Analisando apar√™ncia do paciente...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:41:06.677519+00:00"}
{"message": "[Vision] ‚úÖ Contexto visual: Estou vendo o paciente atrav√©s da c√¢mera. Posso ver sua express√£o facial e ambiente ao redor.", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:41:06.677654+00:00"}
{"message": "[Vision] üì∏ Analisando apar√™ncia do paciente...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:41:21.680563+00:00"}
{"message": "[Vision] ‚úÖ Contexto visual: Estou vendo o paciente atrav√©s da c√¢mera. Posso ver sua express√£o facial e ambiente ao redor.", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:41:21.680695+00:00"}
{"message": "[Metrics] N√£o √© poss√≠vel enviar m√©tricas sem AGENT_SECRET", "level": "WARNING", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:41:31.657895+00:00"}
{"message": "[Vision] üì∏ Analisando apar√™ncia do paciente...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:41:36.683572+00:00"}
{"message": "[Vision] ‚úÖ Contexto visual: Estou vendo o paciente atrav√©s da c√¢mera. Posso ver sua express√£o facial e ambiente ao redor.", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:41:36.683689+00:00"}
{"message": "[Vision] üì∏ Analisando apar√™ncia do paciente...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:41:51.687582+00:00"}
{"message": "[Vision] ‚úÖ Contexto visual: Estou vendo o paciente atrav√©s da c√¢mera. Posso ver sua express√£o facial e ambiente ao redor.", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:41:51.687757+00:00"}
{"message": "[Vision] üì∏ Analisando apar√™ncia do paciente...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:42:06.688316+00:00"}
{"message": "[Vision] ‚úÖ Contexto visual: Estou vendo o paciente atrav√©s da c√¢mera. Posso ver sua express√£o facial e ambiente ao redor.", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:42:06.688495+00:00"}
{"message": "[Vision] üì∏ Analisando apar√™ncia do paciente...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:42:21.690801+00:00"}
{"message": "[Vision] ‚úÖ Contexto visual: Estou vendo o paciente atrav√©s da c√¢mera. Posso ver sua express√£o facial e ambiente ao redor.", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:42:21.690946+00:00"}
{"message": "[Metrics] N√£o √© poss√≠vel enviar m√©tricas sem AGENT_SECRET", "level": "WARNING", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:42:31.658686+00:00"}
{"message": "[Vision] üì∏ Analisando apar√™ncia do paciente...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:42:36.693062+00:00"}
{"message": "[Vision] ‚úÖ Contexto visual: Estou vendo o paciente atrav√©s da c√¢mera. Posso ver sua express√£o facial e ambiente ao redor.", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:42:36.693200+00:00"}
{"message": "[Vision] üì∏ Analisando apar√™ncia do paciente...", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:42:51.695571+00:00"}
{"message": "[Vision] ‚úÖ Contexto visual: Estou vendo o paciente atrav√©s da c√¢mera. Posso ver sua express√£o facial e ambiente ao redor.", "level": "INFO", "name": "mediai-avatar", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:42:51.695720+00:00"}
{"message": "process exiting", "level": "INFO", "name": "livekit.agents", "reason": "", "pid": 6352, "job_id": "AJ_Gx9w4LeGgY7m", "timestamp": "2025-11-14T17:42:52.960295+00:00"}
